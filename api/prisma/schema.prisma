generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Comments {
  id            Int      @id @default(autoincrement())
  content       String
  fk_user_id    Int?
  public        Boolean  @default(true)
  fk_product_id Int
  Products      Products @relation(fields: [fk_product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Users         Users?   @relation(fields: [fk_user_id], references: [id], onUpdate: NoAction)
}

model ProductCategories {
  id                      Int                 @id @default(autoincrement())
  name                    String              @db.VarChar(255)
  fk_pc_parant_id         Int?
  ProductCategories       ProductCategories?  @relation("ProductCategoriesToProductCategories", fields: [fk_pc_parant_id], references: [id], onUpdate: NoAction)
  other_ProductCategories ProductCategories[] @relation("ProductCategoriesToProductCategories")
  Products                Products[]
}

model ProductFavorite {
  id            Int       @id @default(autoincrement())
  fk_user_id    Int?
  fk_product_id Int?
  Products      Products? @relation(fields: [fk_product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Users         Users?    @relation(fields: [fk_user_id], references: [id], onUpdate: NoAction)

  @@unique([fk_user_id, fk_product_id])
}

model ProductImages {
  id            Int      @id @default(autoincrement())
  fk_product_id Int
  imagepath     String
  Products      Products @relation(fields: [fk_product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Products {
  id                      Int                @id @default(autoincrement())
  fk_user_id              Int?
  price                   Decimal            @db.Decimal(10, 2)
  description             String?
  state                   product_state      @default(Open)
  fk_productcategories_id Int?
  Comments                Comments[]
  ProductFavorite         ProductFavorite[]
  ProductImages           ProductImages[]
  ProductCategories       ProductCategories? @relation(fields: [fk_productcategories_id], references: [id], onUpdate: NoAction)
  Users                   Users?             @relation(fields: [fk_user_id], references: [id], onUpdate: NoAction)
}

model Users {
  id              Int               @id @default(autoincrement())
  username        String            @unique @db.VarChar(255)
  hashedpassword  String            @db.VarChar(64)
  salt            String            @db.VarChar(36)
  firstname       String            @db.VarChar(255)
  lastname        String            @db.VarChar(255)
  email           String            @unique @db.VarChar(255)
  phone           String            @db.VarChar(8)
  signedup        DateTime          @default(now()) @db.Timestamp(6)
  Comments        Comments[]
  ProductFavorite ProductFavorite[]
  Products        Products[]
}

enum product_state {
  Open
  Sold
  Deactivated
}
